<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Selamat Hari Raya Aidilfitri</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            primary: {
              DEFAULT: '#5D5CDE',
              light: '#8281E9',
              dark: '#4A49B2'
            },
            secondary: {
              DEFAULT: '#E15EB0',
              light: '#F385C7',
              dark: '#B84A8D'
            },
            background: {
              light: '#FFFFFF',
              dark: '#181818'
            },
            raya: {
              green: '#2CA735',
              gold: '#FFCB45',
              teal: '#1D9E9E',
              malay: '#26547C'
            }
          },
          animation: {
            'float': 'float 6s ease-in-out infinite',
            'spin-slow': 'spin 15s linear infinite',
            'sparkle': 'sparkle 2s linear infinite',
            'fade-in': 'fadeIn 2s ease-in-out',
            'slide-up': 'slideUp 1s ease-out',
            'bounce-light': 'bounceLight 2s infinite',
            'confetti-fall': 'confettiFall 8s linear infinite',
          }
        }
      }
    }
  </script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Amiri:wght@400;700&display=swap');

    body {
      font-family: 'Poppins', sans-serif;
      overflow-x: hidden;
    }

    .ketupat {
      clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
    }

    .light-rays {
      background: radial-gradient(circle at center, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0) 70%);
    }

    .dark .light-rays {
      background: radial-gradient(circle at center, rgba(93,92,222,0.3) 0%, rgba(93,92,222,0) 70%);
    }

    @keyframes lampPulse {
      0%, 100% {
        filter: drop-shadow(0 0 8px rgba(255, 234, 156, 0.8));
      }
      50% {
        filter: drop-shadow(0 0 15px rgba(255, 234, 156, 1));
      }
    }

    .lamp {
      animation: lampPulse 3s infinite ease-in-out;
    }

    .dark .lamp {
      animation: lampPulse 3s infinite ease-in-out;
    }

    /* Audio player custom styling */
    .audio-player {
      --player-bg: #8281E9;
      --player-text: white;
      --player-btn: #F385C7;
      --player-btn-hover: #B8u4A8D;
    }

    .dark .audio-player {
      --player-bg: #4A49B2;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }

    .dark ::-webkit-scrollbar-track {
      background: #333;
    }

    ::-webkit-scrollbar-thumb {
      background: #5D5CDE;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #4A49B2;
    }
    
    /* Audio visualizer animation */
    @keyframes equalizer-bar1 { 0%, 100% { height: 2px; } 50% { height: 8px; } }
    @keyframes equalizer-bar2 { 0%, 100% { height: 3px; } 30% { height: 9px; } }
    @keyframes equalizer-bar3 { 0%, 100% { height: 5px; } 40% { height: 10px; } }
    @keyframes equalizer-bar4 { 0%, 100% { height: 7px; } 60% { height: 12px; } }
    @keyframes equalizer-bar5 { 0%, 100% { height: 5px; } 70% { height: 9px; } }
    @keyframes equalizer-bar6 { 0%, 100% { height: 4px; } 50% { height: 8px; } }
    @keyframes equalizer-bar7 { 0%, 100% { height: 3px; } 40% { height: 7px; } }
    
    #audioVisualizer.active .audio-bar:nth-child(1) { animation: equalizer-bar1 0.9s ease-in-out infinite; }
    #audioVisualizer.active .audio-bar:nth-child(2) { animation: equalizer-bar2 0.8s ease-in-out infinite; }
    #audioVisualizer.active .audio-bar:nth-child(3) { animation: equalizer-bar3 0.7s ease-in-out infinite; }
    #audioVisualizer.active .audio-bar:nth-child(4) { animation: equalizer-bar4 0.9s ease-in-out infinite; }
    #audioVisualizer.active .audio-bar:nth-child(5) { animation: equalizer-bar5 0.8s ease-in-out infinite; }
    #audioVisualizer.active .audio-bar:nth-child(6) { animation: equalizer-bar6 0.7s ease-in-out infinite; }
    #audioVisualizer.active .audio-bar:nth-child(7) { animation: equalizer-bar7 0.6s ease-in-out infinite; }
    
    #audioVisualizer:not(.active) .audio-bar {
      height: 2px;
      transition: height 0.3s ease-out;
    }

    /* Gallery styles */
    @keyframes fadeIn {
      0% { opacity: 0; }
      100% { opacity: 1; }
    }
    
    @keyframes slideUp {
      0% { transform: translateY(30px); opacity: 0; }
      100% { transform: translateY(0); opacity: 1; }
    }
    
    @keyframes bounceLight {
      0%, 100% { transform: translateY(0); opacity: 1; }
      50% { transform: translateY(-5px); opacity: 0.7; }
    }
    
    /* Slider animation */
    @keyframes slideIn {
      0% { transform: translateX(100%); opacity: 0; }
      100% { transform: translateX(0); opacity: 1; }
    }
    
    @keyframes slideOut {
      0% { transform: translateX(0); opacity: 1; }
      100% { transform: translateX(-100%); opacity: 0; }
    }
    
    .slide-active {
      animation: slideIn 0.5s forwards;
    }
    
    .slide-inactive {
      animation: slideOut 0.5s forwards;
    }
    
    /* Flip animation */
    @keyframes flipIn {
      0% { transform: rotateY(90deg); opacity: 0; }
      100% { transform: rotateY(0deg); opacity: 1; }
    }
    
    .flip-active {
      animation: flipIn 0.7s forwards;
      backface-visibility: hidden;
      transform-style: preserve-3d;
    }
    
    /* Gallery button pulse */
    @keyframes galleryPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    .gallery-btn {
      animation: galleryPulse 2s infinite ease-in-out;
    }
    
    /* Confetti animation */
    @keyframes confettiFall {
      0% { transform: translateY(-10px) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
    }
    
    .confetti {
      position: absolute;
      width: 8px;
      height: 8px;
      opacity: 0.6;
      animation: confettiFall linear infinite;
    }
    
    /* Arabic text style */
    .arabic-text {
      font-family: 'Amiri', serif;
      direction: rtl;
    }
    
    /* Enhanced button styles */
    .enhanced-btn {
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .enhanced-btn:before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: all 0.6s ease;
    }
    
    .enhanced-btn:hover:before {
      left: 100%;
    }
    
    /* Image frame with pattern border */
    .raya-frame {
      position: relative;
      padding: 10px;
      background: linear-gradient(45deg, #FFCB45, #5D5CDE, #E15EB0);
      border-radius: 0.5rem;
    }
    
    .raya-frame::before {
      content: '';
      position: absolute;
      inset: 2px;
      background: white;
      border-radius: 0.3rem;
      z-index: 0;
    }
    
    .dark .raya-frame::before {
      background: #181818;
    }
    
    .raya-frame img {
      position: relative;
      z-index: 1;
      border-radius: 0.2rem;
    }
    
    /* Float animation */
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-15px); }
    }
    
    /* Sparkle animation */
    @keyframes sparkle {
      0%, 100% { opacity: 0.2; transform: scale(0.8); }
      50% { opacity: 1; transform: scale(1.2); }
    }
    
    /* Custom tooltip */
    .tooltip {
      position: relative;
    }
    
    .tooltip::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      padding: 5px 10px;
      background: rgba(0,0,0,0.7);
      color: white;
      border-radius: 4px;
      font-size: 12px;
      white-space: nowrap;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .tooltip:hover::after {
      opacity: 1;
      visibility: visible;
    }
  </style>
</head>
<body class="bg-background-light dark:bg-background-dark transition-colors duration-300">
  <!-- Check for dark mode -->
  <script>
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      document.documentElement.classList.add('dark');
    }
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
      if (event.matches) {
        document.documentElement.classList.add('dark');
      } else {
        document.documentElement.classList.remove('dark');
      }
    });
  </script>

  <!-- Main Container -->
  <div class="min-h-screen flex flex-col items-center justify-center p-4 relative overflow-hidden">
    <!-- Background decorative elements -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
      <!-- Top Left Ketupat -->
      <div class="absolute top-5 left-5 w-20 h-20 ketupat bg-primary-light dark:bg-primary-dark opacity-30 animate-float"></div>
      
      <!-- Top Right Crescent Moon -->
      <svg class="absolute top-10 right-10 w-16 h-16 text-secondary-light dark:text-secondary animate-float" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 2C6.49 2 2 6.49 2 12C2 17.51 6.49 22 12 22C14.9 22 17.36 20.65 19.08 18.55C17.84 19.15 16.4 19.5 14.87 19.5C9.64 19.5 5.38 15.24 5.38 10.01C5.38 7.02 6.71 4.34 8.86 2.58C8.86 2.58 8.86 2.58 8.86 2.58C9.85 2.21 10.9 2 12 2Z"/>
      </svg>
      
      <!-- Bottom Left Stars -->
      <div class="absolute bottom-20 left-10">
        <svg class="w-6 h-6 text-secondary animate-sparkle" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z"/>
        </svg>
      </div>
      <div class="absolute bottom-10 left-20">
        <svg class="w-4 h-4 text-primary-light dark:text-primary animate-sparkle" style="animation-delay: 0.5s;" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z"/>
        </svg>
      </div>
      
      <!-- Bottom Right Decorative Elements -->
      <div class="absolute bottom-5 right-5 w-24 h-24 ketupat rotate-45 bg-secondary-light dark:bg-secondary opacity-20 animate-spin-slow"></div>
      
      <!-- Floating Lamps -->
      <div class="lamp absolute top-1/4 left-1/4 w-8 h-12 bg-yellow-200 dark:bg-yellow-300 rounded-full opacity-70 animate-bounce-light"></div>
      <div class="lamp absolute top-1/3 right-1/3 w-6 h-10 bg-yellow-200 dark:bg-yellow-300 rounded-full opacity-70 animate-bounce-light" style="animation-delay: 1s;"></div>
      
      <!-- Additional decorative elements (Hari Raya themed) -->
      <img src="https://i.imgur.com/QJxp5T1.png" alt="Ketupat decoration" class="absolute top-16 left-1/4 w-12 h-12 animate-float" style="animation-delay: 1.5s;">
      <img src="https://i.imgur.com/I3A7A54.png" alt="Lantern decoration" class="absolute bottom-1/4 right-16 w-14 h-14 animate-bounce-light" style="animation-delay: 0.7s;">
      <img src="https://i.imgur.com/ocJZj8m.png" alt="Decorative crescent" class="absolute top-20 right-1/4 w-10 h-10 animate-float" style="animation-delay: 2s;">
      
      <!-- Light Rays Behind Main Card -->
      <div class="light-rays absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[200%] h-[200%] opacity-50"></div>
      
      <!-- Subtle confetti effect -->
      <div id="confettiContainer" class="absolute inset-0 overflow-hidden"></div>
    </div>

    <!-- Main Card -->
    <div class="relative z-10 w-full max-w-xl bg-white dark:bg-gray-800 rounded-xl shadow-2xl overflow-hidden animate-fade-in transition-transform duration-500 hover:shadow-[0_0_40px_rgba(93,92,222,0.4)]">
      
      <!-- Updated Header Section (No Gradient) -->
      <!-- Replace 'YOUR_IMAGE_URL.jpg' below with the actual path/URL to the new purple mosque image you uploaded -->
      <div class="h-48 relative overflow-hidden">
        <img src="https://i.imgur.com/9G6ABBa.gif" alt="Hari Raya Background" class="absolute inset-0 w-full h-full object-cover">
        <div class="relative z-10 flex flex-col items-center justify-center h-full text-white text-center px-4">
          <h1 class="text-4xl md:text-5xl font-bold"></h1>
          <p class="mt-2 text-xl md:text-2xl"></p>
          <!-- Optional Arabic Calligraphy -->
          <p class="arabic-text mt-2 text-2xl md:text-3xl"></p>
        </div>
      </div>
      
      <!-- Card Content -->
      <div class="p-6 text-center">
        <h1 class="text-3xl md:text-4xl font-bold text-raya-malay dark:text-primary-light mb-2 animate-slide-up">Selamat Hari Raya</h1>
        <h2 class="text-2xl md:text-3xl font-bold text-secondary-dark dark:text-secondary-light mb-2 animate-slide-up" style="animation-delay: 0.2s;">Aidilfitri</h2>
        
        <p class="arabic-text text-xl text-raya-teal dark:text-raya-gold mb-2 animate-slide-up" style="animation-delay: 0.3s;">
          عيد الفطر مبارك
        </p>
        
        <p class="text-gray-600 dark:text-gray-300 mb-6 animate-slide-up" style="animation-delay: 0.4s;">
          Maaf Zahir dan Batin
        </p>
        
        <!-- Decorative Ketupat -->
        <div class="flex justify-center space-x-4 mb-6">
          <div class="ketupat w-16 h-16 bg-gradient-to-br from-primary-light to-primary-dark transform rotate-45 animate-float shadow-lg">
            <div class="absolute inset-2 ketupat bg-white dark:bg-gray-800"></div>
          </div>
          <div class="ketupat w-16 h-16 bg-gradient-to-br from-secondary-light to-secondary-dark transform rotate-45 animate-float shadow-lg" style="animation-delay: 0.5s;">
            <div class="absolute inset-2 ketupat bg-white dark:bg-gray-800"></div>
          </div>
          <div class="ketupat w-16 h-16 bg-gradient-to-br from-raya-green to-raya-gold transform rotate-45 animate-float shadow-lg" style="animation-delay: 1s;">
            <div class="absolute inset-2 ketupat bg-white dark:bg-gray-800"></div>
          </div>
        </div>
        
        <!-- Gallery Button -->
        <div class="mb-6 animate-slide-up" style="animation-delay: 0.5s;">
          <button id="galleryBtn" class="enhanced-btn gallery-btn bg-gradient-to-r from-raya-malay to-primary hover:from-primary hover:to-primary-dark dark:from-primary-dark dark:to-raya-teal dark:hover:from-primary dark:hover:to-primary-dark text-white py-3 px-6 rounded-lg shadow-lg transform transition-all duration-300 flex items-center justify-center mx-auto">
            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
            </svg>
            View Raya Gallery
          </button>
        </div>
        
        <!-- Video Thumbnail -->
        <div class="mb-6 animate-slide-up" style="animation-delay: 0.6s;">
          <div class="raya-frame inline-block">
            <div id="videoBtn" class="relative mx-auto cursor-pointer max-w-md hover:opacity-95 transition-opacity rounded-lg overflow-hidden shadow-lg transform hover:scale-105 transition-all duration-300">
              <img src="https://i.imgur.com/BFXtusG.gif" alt="Raya Video Thumbnail" class="w-full rounded-lg">
              <div class="absolute inset-0 flex items-center justify-center bg-black bg-opacity-20 hover:bg-opacity-10 transition-all">
                <svg class="w-16 h-16 text-white drop-shadow-lg transform hover:scale-110 transition-transform duration-300" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M8 5v14l11-7z"/>
                </svg>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Background Music Player -->
        <div class="mt-6 mb-2">
          <h3 class="text-gray-600 dark:text-gray-300 mb-2 flex items-center justify-center">
            <svg class="w-5 h-5 mr-2 text-raya-green dark:text-raya-gold" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/>
            </svg>
            Sayang, Jom Nyanyi!
          </h3>
          <div class="relative" style="width:100%;max-width:660px;margin:0 auto;">
            <!-- HTML5 Audio element (hidden but plays in background) -->
            <audio id="backgroundMusic" autoplay loop muted style="display:none;">
              <source src="https://finebank.github.io/uitmsabah/Meriah_Lain_Macam_Hael_Husaini_Nadeera_Official_Music_Video_V1.mp3" type="audio/mpeg">
            </audio>
            
            <!-- Custom audio controls that reflect the playing state -->
            <div class="bg-gradient-to-r from-primary-light to-secondary-light dark:from-primary-dark dark:to-secondary-dark text-white p-3 rounded-lg flex items-center justify-between shadow-lg">
              <button id="playPauseBtn" class="enhanced-btn bg-secondary-light hover:bg-secondary-dark text-white rounded-full w-10 h-10 flex items-center justify-center mr-3 tooltip" data-tooltip="Play/Pause">
                <svg id="pauseIcon" class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
                </svg>
                <svg id="playIcon" class="w-6 h-6 hidden" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M8 5v14l11-7z"/>
                </svg>
              </button>
              <div class="flex flex-col">
                <span class="text-sm md:text-base"></span>
                <!-- Audio visualizer (animated bars) -->
                <div id="audioVisualizer" class="flex h-3 items-end space-x-[2px] mt-1">
                  <div class="audio-bar w-1 bg-white rounded-t"></div>
                  <div class="audio-bar w-1 bg-white rounded-t"></div>
                  <div class="audio-bar w-1 bg-white rounded-t"></div>
                  <div class="audio-bar w-1 bg-white rounded-t"></div>
                  <div class="audio-bar w-1 bg-white rounded-t"></div>
                  <div class="audio-bar w-1 bg-white rounded-t"></div>
                  <div class="audio-bar w-1 bg-white rounded-t"></div>
                </div>
              </div>
              <div class="flex items-center space-x-2">
                <span class="text-xs">Vol</span>
                <input type="range" id="volumeSlider" min="0" max="1" step="0.1" value="0.3" class="w-14 h-2 accent-white">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Copyright -->
    <div class="mt-4 text-center text-gray-500 dark:text-gray-400 text-sm">
      &copy; 2025 FPP UiTM Cawangan Sabah | SirPoji
    </div>
  </div>
  
  <!-- Video Modal -->
  <div id="videoModal" class="fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center hidden backdrop-blur-sm">
    <div class="relative bg-white dark:bg-gray-800 rounded-lg max-w-4xl w-full mx-4 transition-transform duration-500 transform scale-100">
      <button id="closeModalBtn" class="absolute -top-10 right-0 text-white hover:text-secondary-light text-3xl enhanced-btn">&times;</button>
      <div class="p-2">
        <div class="relative" style="padding-top: 56.25%;">
          <video id="videoPlayer" class="absolute inset-0 w-full h-full rounded-lg" controls></video>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Image Gallery Modal -->
  <div id="galleryModal" class="fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center hidden backdrop-blur-sm">
    <div class="relative bg-white dark:bg-gray-800 rounded-lg max-w-4xl w-full mx-4 py-4 transition-transform duration-500 transform scale-100">
      <button id="closeGalleryBtn" class="absolute -top-10 right-0 text-white hover:text-secondary-light text-3xl enhanced-btn">&times;</button>
      
      <div class="p-2">
        <h2 class="text-2xl font-bold text-raya-malay dark:text-primary-light text-center mb-4">Raya Gallery</h2>
        
        <!-- Slider Container -->
        <div class="relative overflow-hidden rounded-lg shadow-xl" style="height: 50vh; max-height: 500px;">
          <div id="sliderContainer" class="w-full h-full relative">
            <!-- Images will be inserted here by JavaScript -->
          </div>
          
          <!-- Navigation Arrows -->
          <button id="prevSlide" class="absolute left-0 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 hover:bg-opacity-70 text-white p-2 rounded-r-lg z-10 enhanced-btn">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
          </button>
          <button id="nextSlide" class="absolute right-0 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 hover:bg-opacity-70 text-white p-2 rounded-l-lg z-10 enhanced-btn">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </button>
        </div>
        
        <!-- Display Mode Toggle -->
        <div class="flex justify-center mt-4 gap-4">
          <button id="sliderMode" class="py-2 px-4 bg-primary text-white rounded-lg active enhanced-btn">Slider</button>
          <button id="flipMode" class="py-2 px-4 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-white rounded-lg enhanced-btn">Flip</button>
        </div>
        
        <!-- Image Counter -->
        <div class="text-center mt-2 text-raya-malay dark:text-gray-300">
          <span id="currentSlide">1</span> / <span id="totalSlides">7</span>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // Element references
    const videoBtn = document.getElementById('videoBtn');
    const videoModal = document.getElementById('videoModal');
    const videoPlayer = document.getElementById('videoPlayer');
    const closeModalBtn = document.getElementById('closeModalBtn');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const playIcon = document.getElementById('playIcon');
    const pauseIcon = document.getElementById('pauseIcon');
    const backgroundMusic = document.getElementById('backgroundMusic');
    const volumeSlider = document.getElementById('volumeSlider');
    const audioVisualizer = document.getElementById('audioVisualizer');
    const confettiContainer = document.getElementById('confettiContainer');
    
    // Gallery references
    const galleryBtn = document.getElementById('galleryBtn');
    const galleryModal = document.getElementById('galleryModal');
    const closeGalleryBtn = document.getElementById('closeGalleryBtn');
    const sliderContainer = document.getElementById('sliderContainer');
    const prevSlide = document.getElementById('prevSlide');
    const nextSlide = document.getElementById('nextSlide');
    const sliderMode = document.getElementById('sliderMode');
    const flipMode = document.getElementById('flipMode');
    const currentSlideEl = document.getElementById('currentSlide');
    const totalSlidesEl = document.getElementById('totalSlides');
    
    // Gallery settings and state
    let currentSlide = 0;
    let displayMode = 'slider'; // 'slider' or 'flip'
    
    // Collection of images for the gallery
    const galleryImages = [
      // Real Hari Raya images from allowed domains
      'https://images.unsplash.com/photo-1587463272361-565230be60a4?q=80&w=1000',
      'https://i.imgur.com/RUzGCjh.jpg',
      'https://i.imgur.com/CFQNPDO.jpg',
      'https://i.imgur.com/6NiC3AA.jpg',
      'https://i.imgur.com/dJQ1IlQ.jpg',
      'https://i.imgur.com/b5RXcai.jpg',
      'https://i.imgur.com/MFUKkfS.jpg'
    ];
    
    // Initialize the gallery and set the total slides
    totalSlidesEl.textContent = galleryImages.length.toString();
    
    // Create confetti pieces for background animation
    function createConfetti() {
      const colors = ['#5D5CDE', '#E15EB0', '#FFCB45', '#2CA735', '#26547C'];
      const shapes = ['circle', 'square', 'triangle'];
      
      for (let i = 0; i < 50; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        
        // Random properties
        const shape = shapes[Math.floor(Math.random() * shapes.length)];
        const color = colors[Math.floor(Math.random() * colors.length)];
        const left = Math.random() * 100 + 'vw';
        const animationDuration = 5 + Math.random() * 10 + 's';
        const animationDelay = Math.random() * 5 + 's';
        
        // Apply styles
        confetti.style.left = left;
        confetti.style.backgroundColor = color;
        confetti.style.animationDuration = animationDuration;
        confetti.style.animationDelay = animationDelay;
        
        // Shape-specific styles
        if (shape === 'circle') {
          confetti.style.borderRadius = '50%';
        } else if (shape === 'triangle') {
          confetti.style.width = '0';
          confetti.style.height = '0';
          confetti.style.backgroundColor = 'transparent';
          confetti.style.borderLeft = '5px solid transparent';
          confetti.style.borderRight = '5px solid transparent';
          confetti.style.borderBottom = '10px solid ' + color;
        }
        
        confettiContainer.appendChild(confetti);
      }
    }
    
    // Set initial volume for non-intrusive background music
    backgroundMusic.volume = 0.3;

    // Function to update audio visualizer state
    function updateVisualizerState() {
      if (backgroundMusic.paused) {
        audioVisualizer.classList.remove('active');
      } else {
        audioVisualizer.classList.add('active');
      }
    }
    
    // Initialize gallery slides
    function initializeGallery() {
      sliderContainer.innerHTML = '';
      
      galleryImages.forEach((src, index) => {
        const slide = document.createElement('div');
        slide.className = index === currentSlide ? 'absolute inset-0 flex items-center justify-center' : 'absolute inset-0 flex items-center justify-center hidden';
        
        const imgContainer = document.createElement('div');
        imgContainer.className = 'relative max-w-full max-h-full p-2';
        
        const img = document.createElement('img');
        img.src = src;
        img.alt = `Raya Image ${index + 1}`;
        img.className = 'max-w-full max-h-[45vh] object-contain rounded-lg shadow-lg';
        img.loading = 'lazy';
        
        imgContainer.appendChild(img);
        slide.appendChild(imgContainer);
        sliderContainer.appendChild(slide);
      });
      
      updateSlideCounter();
    }
    
    // Update the slide counter
    function updateSlideCounter() {
      currentSlideEl.textContent = (currentSlide + 1).toString();
    }
    
    // Show a specific slide
    function showSlide(index) {
      // Remove all current animations and hide all slides
      const slides = sliderContainer.querySelectorAll('div.absolute');
      slides.forEach(slide => {
        slide.className = 'absolute inset-0 flex items-center justify-center hidden';
      });
      
      // Show the current slide with appropriate animation
      if (displayMode === 'slider') {
        slides[index].className = 'absolute inset-0 flex items-center justify-center slide-active';
      } else {
        slides[index].className = 'absolute inset-0 flex items-center justify-center flip-active';
      }
      
      currentSlide = index;
      updateSlideCounter();
    }
    
    // Navigate to previous slide
    function prevSlideHandler() {
      let newIndex = currentSlide - 1;
      if (newIndex < 0) newIndex = galleryImages.length - 1;
      showSlide(newIndex);
    }
    
    // Navigate to next slide
    function nextSlideHandler() {
      let newIndex = currentSlide + 1;
      if (newIndex >= galleryImages.length) newIndex = 0;
      showSlide(newIndex);
    }
    
    // Toggle between slider and flip modes
    function toggleDisplayMode(mode) {
      displayMode = mode;
      
      if (mode === 'slider') {
        sliderMode.className = 'py-2 px-4 bg-primary text-white rounded-lg enhanced-btn';
        flipMode.className = 'py-2 px-4 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-white rounded-lg enhanced-btn';
      } else {
        flipMode.className = 'py-2 px-4 bg-primary text-white rounded-lg enhanced-btn';
        sliderMode.className = 'py-2 px-4 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-white rounded-lg enhanced-btn';
      }
      
      // Reshow current slide with new animation
      showSlide(currentSlide);
    }
    
    // Handle autoplay issues on page load
    document.addEventListener('DOMContentLoaded', function() {
      // Create the confetti animation
      createConfetti();
      
      // Attempt to play the audio (it is muted initially)
      backgroundMusic.play().then(() => {
        updateVisualizerState();
      }).catch(error => {
        console.log("Autoplay prevented: ", error);
        playIcon.classList.remove('hidden');
        pauseIcon.classList.add('hidden');
        updateVisualizerState();
      });

      // Automatically unmute after 5 seconds
      setTimeout(function() {
        backgroundMusic.muted = false;
        backgroundMusic.play().catch(error => {
          console.log("Error playing audio after unmute:", error);
        });
      }, 5000);
      
      // Initialize the gallery
      initializeGallery();
      
      // Add hover effects to buttons
      const buttons = document.querySelectorAll('button');
      buttons.forEach(button => {
        button.addEventListener('mouseenter', function() {
          this.classList.add('scale-105');
        });
        button.addEventListener('mouseleave', function() {
          this.classList.remove('scale-105');
        });
      });
    });

    // Update volume from slider
    volumeSlider.addEventListener('input', function() {
      backgroundMusic.volume = this.value;
    });

    // Add audio event listeners to update visualizer state
    backgroundMusic.addEventListener('play', updateVisualizerState);
    backgroundMusic.addEventListener('pause', updateVisualizerState);
    backgroundMusic.addEventListener('ended', updateVisualizerState);

    // Control background music manually
    playPauseBtn.addEventListener('click', () => {
      if (backgroundMusic.paused) {
        backgroundMusic.play();
        playIcon.classList.add('hidden');
        pauseIcon.classList.remove('hidden');
      } else {
        backgroundMusic.pause();
        playIcon.classList.remove('hidden');
        pauseIcon.classList.add('hidden');
      }
    });

    // Video modal functionality
    videoBtn.addEventListener('click', () => {
      videoModal.classList.remove('hidden');
      videoPlayer.src = "https://finebank.github.io/uitmsabah/Selamat Hari Raya_20250326_191322_0000.mp4";

      // Add entrance animation
      const modalContent = videoModal.querySelector('.relative');
      modalContent.classList.add('scale-100');
      modalContent.classList.remove('scale-90');

      // Pause the background music when video is opened
      backgroundMusic.pause();
      playIcon.classList.remove('hidden');
      pauseIcon.classList.add('hidden');
      updateVisualizerState();

      // Attempt to play video automatically
      videoPlayer.play().then(() => {
        console.log("Video started playing");
      }).catch(error => {
        console.log("Autoplay prevented for video: ", error);
      });
    });

    closeModalBtn.addEventListener('click', () => {
      // Add exit animation
      const modalContent = videoModal.querySelector('.relative');
      modalContent.classList.remove('scale-100');
      modalContent.classList.add('scale-90');
      
      // Wait for animation to complete
      setTimeout(() => {
        videoModal.classList.add('hidden');
        videoPlayer.pause();
        videoPlayer.src = "";
      }, 300);
    });
    
    // Gallery modal functionality
    galleryBtn.addEventListener('click', () => {
      galleryModal.classList.remove('hidden');
      
      // Add entrance animation
      const modalContent = galleryModal.querySelector('.relative');
      modalContent.classList.add('scale-100');
      modalContent.classList.remove('scale-90');
      
      // Initialize or refresh gallery
      initializeGallery();
    });
    
    closeGalleryBtn.addEventListener('click', () => {
      // Add exit animation
      const modalContent = galleryModal.querySelector('.relative');
      modalContent.classList.remove('scale-100');
      modalContent.classList.add('scale-90');
      
      // Wait for animation to complete
      setTimeout(() => {
        galleryModal.classList.add('hidden');
      }, 300);
    });
    
    // Gallery navigation
    prevSlide.addEventListener('click', prevSlideHandler);
    nextSlide.addEventListener('click', nextSlideHandler);
    
    // Display mode toggles
    sliderMode.addEventListener('click', () => toggleDisplayMode('slider'));
    flipMode.addEventListener('click', () => toggleDisplayMode('flip'));

    // Close modals when clicking outside the content
    videoModal.addEventListener('click', (e) => {
      if (e.target === videoModal) {
        // Add exit animation
        const modalContent = videoModal.querySelector('.relative');
        modalContent.classList.remove('scale-100');
        modalContent.classList.add('scale-90');
        
        setTimeout(() => {
          videoModal.classList.add('hidden');
          videoPlayer.pause();
          videoPlayer.src = "";
        }, 300);
      }
    });
    
    galleryModal.addEventListener('click', (e) => {
      if (e.target === galleryModal) {
        // Add exit animation
        const modalContent = galleryModal.querySelector('.relative');
        modalContent.classList.remove('scale-100');
        modalContent.classList.add('scale-90');
        
        setTimeout(() => {
          galleryModal.classList.add('hidden');
        }, 300);
      }
    });

    // Listen for fullscreen change events
    document.addEventListener('fullscreenchange', exitHandler);
    document.addEventListener('webkitfullscreenchange', exitHandler);
    document.addEventListener('mozfullscreenchange', exitHandler);
    document.addEventListener('MSFullscreenChange', exitHandler);

    function exitHandler() {
      if (!document.fullscreenElement && 
          !document.webkitIsFullScreen && 
          !document.mozFullScreen && 
          !document.msFullscreenElement) {
        // The user has exited fullscreen mode
      }
    }

    // Decorative animations for floating elements
    const floatingElements = document.querySelectorAll('.animate-float');
    floatingElements.forEach((elem, index) => {
      elem.style.animationDelay = `${index * 0.2}s`;
    });

    // Handle escape key to close modals
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        if (!videoModal.classList.contains('hidden')) {
          // Add exit animation
          const modalContent = videoModal.querySelector('.relative');
          modalContent.classList.remove('scale-100');
          modalContent.classList.add('scale-90');
          
          setTimeout(() => {
            videoModal.classList.add('hidden');
            videoPlayer.pause();
            videoPlayer.src = "";
          }, 300);
        }
        
        if (!galleryModal.classList.contains('hidden')) {
          // Add exit animation
          const modalContent = galleryModal.querySelector('.relative');
          modalContent.classList.remove('scale-100');
          modalContent.classList.add('scale-90');
          
          setTimeout(() => {
            galleryModal.classList.add('hidden');
          }, 300);
        }
      }
    });
    
    // Add keyboard navigation for gallery
    document.addEventListener('keydown', (e) => {
      if (!galleryModal.classList.contains('hidden')) {
        if (e.key === 'ArrowLeft') {
          prevSlideHandler();
        } else if (e.key === 'ArrowRight') {
          nextSlideHandler();
        }
      }
    });
    
    // Add touch swipe support for gallery
    let touchStartX = 0;
    let touchEndX = 0;
    
    sliderContainer.addEventListener('touchstart', (e) => {
      touchStartX = e.changedTouches[0].screenX;
    });
    
    sliderContainer.addEventListener('touchend', (e) => {
      touchEndX = e.changedTouches[0].screenX;
      handleSwipe();
    });
    
    function handleSwipe() {
      if (touchEndX < touchStartX - 50) {
        nextSlideHandler(); // Swipe left → next slide
      } else if (touchEndX > touchStartX + 50) {
        prevSlideHandler(); // Swipe right → previous slide
      }
    }
  </script>
</body>
</html>
