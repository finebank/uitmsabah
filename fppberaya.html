<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Selamat Hari Raya Aidilfitri</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            primary: {
              DEFAULT: '#5D5CDE',
              light: '#8281E9',
              dark: '#4A49B2'
            },
            secondary: {
              DEFAULT: '#E15EB0',
              light: '#F385C7',
              dark: '#B84A8D'
            },
            background: {
              light: '#FFFFFF',
              dark: '#181818'
            }
          },
          animation: {
            'float': 'float 6s ease-in-out infinite',
            'spin-slow': 'spin 15s linear infinite',
            'sparkle': 'sparkle 2s linear infinite',
            'fade-in': 'fadeIn 2s ease-in-out',
            'slide-up': 'slideUp 1s ease-out',
            'bounce-light': 'bounceLight 2s infinite',
          }
        }
      }
    }
  </script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');

    body {
      font-family: 'Poppins', sans-serif;
      overflow-x: hidden;
    }

    .ketupat {
      clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
    }

    .light-rays {
      background: radial-gradient(circle at center, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0) 70%);
    }

    .dark .light-rays {
      background: radial-gradient(circle at center, rgba(93,92,222,0.3) 0%, rgba(93,92,222,0) 70%);
    }

    @keyframes lampPulse {
      0%, 100% {
        filter: drop-shadow(0 0 8px rgba(255, 234, 156, 0.8));
      }
      50% {
        filter: drop-shadow(0 0 15px rgba(255, 234, 156, 1));
      }
    }

    .lamp {
      animation: lampPulse 3s infinite ease-in-out;
    }

    .dark .lamp {
      animation: lampPulse 3s infinite ease-in-out;
    }

    /* Audio player custom styling */
    .audio-player {
      --player-bg: #8281E9;
      --player-text: white;
      --player-btn: #F385C7;
      --player-btn-hover: #B84A8D;
    }

    .dark .audio-player {
      --player-bg: #4A49B2;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }

    .dark ::-webkit-scrollbar-track {
      background: #333;
    }

    ::-webkit-scrollbar-thumb {
      background: #5D5CDE;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #4A49B2;
    }
    
    /* Audio visualizer animation */
    @keyframes equalizer-bar1 { 0%, 100% { height: 2px; } 50% { height: 8px; } }
    @keyframes equalizer-bar2 { 0%, 100% { height: 3px; } 30% { height: 9px; } }
    @keyframes equalizer-bar3 { 0%, 100% { height: 5px; } 40% { height: 10px; } }
    @keyframes equalizer-bar4 { 0%, 100% { height: 7px; } 60% { height: 12px; } }
    @keyframes equalizer-bar5 { 0%, 100% { height: 5px; } 70% { height: 9px; } }
    @keyframes equalizer-bar6 { 0%, 100% { height: 4px; } 50% { height: 8px; } }
    @keyframes equalizer-bar7 { 0%, 100% { height: 3px; } 40% { height: 7px; } }
    
    #audioVisualizer.active .audio-bar:nth-child(1) { animation: equalizer-bar1 0.9s ease-in-out infinite; }
    #audioVisualizer.active .audio-bar:nth-child(2) { animation: equalizer-bar2 0.8s ease-in-out infinite; }
    #audioVisualizer.active .audio-bar:nth-child(3) { animation: equalizer-bar3 0.7s ease-in-out infinite; }
    #audioVisualizer.active .audio-bar:nth-child(4) { animation: equalizer-bar4 0.9s ease-in-out infinite; }
    #audioVisualizer.active .audio-bar:nth-child(5) { animation: equalizer-bar5 0.8s ease-in-out infinite; }
    #audioVisualizer.active .audio-bar:nth-child(6) { animation: equalizer-bar6 0.7s ease-in-out infinite; }
    #audioVisualizer.active .audio-bar:nth-child(7) { animation: equalizer-bar7 0.6s ease-in-out infinite; }
    
    #audioVisualizer:not(.active) .audio-bar {
      height: 2px;
      transition: height 0.3s ease-out;
    }

    /* Gallery styles */
    @keyframes fadeIn {
      0% { opacity: 0; }
      100% { opacity: 1; }
    }
    
    @keyframes slideUp {
      0% { transform: translateY(30px); opacity: 0; }
      100% { transform: translateY(0); opacity: 1; }
    }
    
    @keyframes bounceLight {
      0%, 100% { transform: translateY(0); opacity: 1; }
      50% { transform: translateY(-5px); opacity: 0.7; }
    }
    
    /* Slider animation */
    @keyframes slideIn {
      0% { transform: translateX(100%); opacity: 0; }
      100% { transform: translateX(0); opacity: 1; }
    }
    
    @keyframes slideOut {
      0% { transform: translateX(0); opacity: 1; }
      100% { transform: translateX(-100%); opacity: 0; }
    }
    
    .slide-active {
      animation: slideIn 0.5s forwards;
    }
    
    .slide-inactive {
      animation: slideOut 0.5s forwards;
    }
    
    /* Flip animation */
    @keyframes flipIn {
      0% { transform: rotateY(90deg); opacity: 0; }
      100% { transform: rotateY(0deg); opacity: 1; }
    }
    
    .flip-active {
      animation: flipIn 0.7s forwards;
      backface-visibility: hidden;
      transform-style: preserve-3d;
    }
    
    /* Gallery button pulse */
    @keyframes galleryPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    .gallery-btn {
      animation: galleryPulse 2s infinite ease-in-out;
    }
  </style>
</head>
<body class="bg-background-light dark:bg-background-dark transition-colors duration-300">
  <!-- Check for dark mode -->
  <script>
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      document.documentElement.classList.add('dark');
    }
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
      if (event.matches) {
        document.documentElement.classList.add('dark');
      } else {
        document.documentElement.classList.remove('dark');
      }
    });
  </script>

  <!-- Main Container -->
  <div class="min-h-screen flex flex-col items-center justify-center p-4 relative overflow-hidden">
    <!-- Background decorative elements -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
      <!-- Top Left Ketupat -->
      <div class="absolute top-5 left-5 w-20 h-20 ketupat bg-primary-light dark:bg-primary-dark opacity-30 animate-float"></div>
      
      <!-- Top Right Crescent Moon -->
      <svg class="absolute top-10 right-10 w-16 h-16 text-secondary-light dark:text-secondary animate-float" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 2C6.49 2 2 6.49 2 12C2 17.51 6.49 22 12 22C14.9 22 17.36 20.65 19.08 18.55C17.84 19.15 16.4 19.5 14.87 19.5C9.64 19.5 5.38 15.24 5.38 10.01C5.38 7.02 6.71 4.34 8.86 2.58C8.86 2.58 8.86 2.58 8.86 2.58C9.85 2.21 10.9 2 12 2Z"/>
      </svg>
      
      <!-- Bottom Left Stars -->
      <div class="absolute bottom-20 left-10">
        <svg class="w-6 h-6 text-secondary animate-sparkle" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z"/>
        </svg>
      </div>
      <div class="absolute bottom-10 left-20">
        <svg class="w-4 h-4 text-primary-light dark:text-primary animate-sparkle" style="animation-delay: 0.5s;" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z"/>
        </svg>
      </div>
      
      <!-- Bottom Right Decorative Elements -->
      <div class="absolute bottom-5 right-5 w-24 h-24 ketupat rotate-45 bg-secondary-light dark:bg-secondary opacity-20 animate-spin-slow"></div>
      
      <!-- Floating Lamps -->
      <div class="lamp absolute top-1/4 left-1/4 w-8 h-12 bg-yellow-200 dark:bg-yellow-300 rounded-full opacity-70 animate-bounce-light"></div>
      <div class="lamp absolute top-1/3 right-1/3 w-6 h-10 bg-yellow-200 dark:bg-yellow-300 rounded-full opacity-70 animate-bounce-light" style="animation-delay: 1s;"></div>
      
      <!-- Light Rays Behind Main Card -->
      <div class="light-rays absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[200%] h-[200%] opacity-50"></div>
    </div>

    <!-- Main Card -->
    <div class="relative z-10 w-full max-w-xl bg-white dark:bg-gray-800 rounded-xl shadow-2xl overflow-hidden animate-fade-in">
      <!-- Card Header with Mosque Silhouette -->
      <div class="h-32 bg-gradient-to-r from-primary-light to-secondary-light dark:from-primary-dark dark:to-secondary-dark relative overflow-hidden">
        <!-- Mosque Silhouette -->
        <svg class="absolute bottom-0 left-1/2 transform -translate-x-1/2 h-24 w-full text-white dark:text-gray-800" viewBox="0 0 100 30" fill="currentColor">
          <path d="M0,30 L100,30 L100,25 L95,25 L95,20 L90,20 L90,25 L85,25 L85,15 L80,15 L80,25 L75,25 L75,20 L70,20 L70,25 L65,25 L65,20 L60,15 L55,20 L55,25 L50,25 L50,15 L45,15 L45,25 L40,25 L40,20 L35,20 L35,25 L30,25 L30,15 L25,15 L25,25 L20,25 L20,20 L15,20 L15,25 L10,25 L10,20 L5,20 L5,25 L0,25 L0,30 Z"/>
          <circle cx="50" cy="10" r="5"/>
          <rect x="48" y="0" width="4" height="5"/>
        </svg>
        
        <!-- Decorative Stars -->
        <div class="absolute top-2 left-5 flex space-x-2">
          <svg class="w-3 h-3 text-white animate-sparkle" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z"/>
          </svg>
          <svg class="w-4 h-4 text-white animate-sparkle" style="animation-delay: 0.3s;" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z"/>
          </svg>
          <svg class="w-2 h-2 text-white animate-sparkle" style="animation-delay: 0.7s;" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z"/>
          </svg>
        </div>
        
        <div class="absolute top-3 right-7 flex space-x-1">
          <svg class="w-2 h-2 text-white animate-sparkle" style="animation-delay: 0.2s;" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z"/>
          </svg>
          <svg class="w-3 h-3 text-white animate-sparkle" style="animation-delay: 0.5s;" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z"/>
          </svg>
        </div>
      </div>
      
      <!-- Card Content -->
      <div class="p-6 text-center">
        <h1 class="text-3xl md:text-4xl font-bold text-primary-dark dark:text-primary-light mb-2 animate-slide-up">Selamat Hari Raya</h1>
        <h2 class="text-2xl md:text-3xl font-bold text-secondary-dark dark:text-secondary-light mb-6 animate-slide-up" style="animation-delay: 0.2s;">Aidilfitri</h2>
        
        <p class="text-gray-600 dark:text-gray-300 mb-8 animate-slide-up" style="animation-delay: 0.3s;">
          Maaf Zahir dan Batin
        </p>
        
        <!-- Decorative Ketupat -->
        <div class="flex justify-center space-x-4 mb-8">
          <div class="ketupat w-16 h-16 bg-gradient-to-br from-primary-light to-primary-dark transform rotate-45 animate-float">
            <div class="absolute inset-2 ketupat bg-white dark:bg-gray-800"></div>
          </div>
          <div class="ketupat w-16 h-16 bg-gradient-to-br from-secondary-light to-secondary-dark transform rotate-45 animate-float" style="animation-delay: 0.5s;">
            <div class="absolute inset-2 ketupat bg-white dark:bg-gray-800"></div>
          </div>
          <div class="ketupat w-16 h-16 bg-gradient-to-br from-primary-light to-secondary-light transform rotate-45 animate-float" style="animation-delay: 1s;">
            <div class="absolute inset-2 ketupat bg-white dark:bg-gray-800"></div>
          </div>
        </div>
        
        <!-- Gallery Button -->
        <div class="mb-8 animate-slide-up" style="animation-delay: 0.4s;">
          <button id="galleryBtn" class="gallery-btn bg-primary hover:bg-primary-dark dark:bg-primary-dark dark:hover:bg-primary text-white py-3 px-6 rounded-lg shadow-lg transform transition-all duration-300 flex items-center justify-center mx-auto">
            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
            </svg>
            View Raya Gallery
          </button>
        </div>
        
        <!-- Video Thumbnail -->
        <div class="mb-6 animate-slide-up" style="animation-delay: 0.5s;">
          <div id="videoBtn" class="relative mx-auto cursor-pointer max-w-md hover:opacity-95 transition-opacity rounded-lg overflow-hidden shadow-lg transform hover:scale-105 transition-all duration-300">
            <img src="https://i.imgur.com/BFXtusG.gif" alt="Raya Video Thumbnail" class="w-full rounded-lg">
            <div class="absolute inset-0 flex items-center justify-center bg-black bg-opacity-20 hover:bg-opacity-10 transition-all">
              <svg class="w-16 h-16 text-white drop-shadow-lg" fill="currentColor" viewBox="0 0 24 24">
                <path d="M8 5v14l11-7z"/>
              </svg>
            </div>
          </div>
        </div>
        
        <!-- Background Music Player -->
        <div class="mt-6 mb-2">
          <h3 class="text-gray-600 dark:text-gray-300 mb-2">Sayang, Jom Nyanyi!</h3>
          <div class="relative" style="width:100%;max-width:660px;margin:0 auto;">
            <!-- HTML5 Audio element (hidden but plays in background) -->
            <audio id="backgroundMusic" autoplay loop muted style="display:none;">
              <source src="https://finebank.github.io/uitmsabah/Meriah_Lain_Macam_Hael_Husaini_Nadeera_Official_Music_Video_V1.mp3" type="audio/mpeg">
            </audio>
            
            <!-- Custom audio controls that reflect the playing state -->
            <div class="bg-primary-light dark:bg-primary-dark text-white p-3 rounded-lg flex items-center justify-between">
              <button id="playPauseBtn" class="bg-secondary-light hover:bg-secondary-dark text-white rounded-full w-10 h-10 flex items-center justify-center mr-3">
                <svg id="pauseIcon" class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
                </svg>
                <svg id="playIcon" class="w-6 h-6 hidden" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M8 5v14l11-7z"/>
                </svg>
              </button>
              <div class="flex flex-col">
                <span class="text-sm md:text-base"></span>
                <!-- Audio visualizer (animated bars) -->
                <div id="audioVisualizer" class="flex h-3 items-end space-x-[2px] mt-1">
                  <div class="audio-bar w-1 bg-secondary-light rounded-t"></div>
                  <div class="audio-bar w-1 bg-secondary-light rounded-t"></div>
                  <div class="audio-bar w-1 bg-secondary-light rounded-t"></div>
                  <div class="audio-bar w-1 bg-secondary-light rounded-t"></div>
                  <div class="audio-bar w-1 bg-secondary-light rounded-t"></div>
                  <div class="audio-bar w-1 bg-secondary-light rounded-t"></div>
                  <div class="audio-bar w-1 bg-secondary-light rounded-t"></div>
                </div>
              </div>
              <div class="flex items-center space-x-2">
                <span class="text-xs">Vol</span>
                <input type="range" id="volumeSlider" min="0" max="1" step="0.1" value="0.3" class="w-14 h-2 accent-secondary-light">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Copyright Footer -->
    <div class="mt-4 text-center text-gray-500 dark:text-gray-400 text-sm">
      &copy; 2025 FPP UiTM Cawangan Sabah | SirPoji
    </div>
  </div>
  
  <!-- Video Modal -->
  <div id="videoModal" class="fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center hidden">
    <div class="relative bg-white dark:bg-gray-800 rounded-lg max-w-4xl w-full mx-4">
      <button id="closeModalBtn" class="absolute -top-10 right-0 text-white hover:text-secondary-light text-2xl">&times;</button>
      <div class="p-2">
        <div class="relative" style="padding-top: 56.25%;">
          <video id="videoPlayer" class="absolute inset-0 w-full h-full rounded-lg" controls></video>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Image Gallery Modal -->
  <div id="galleryModal" class="fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center hidden">
    <div class="relative bg-white dark:bg-gray-800 rounded-lg max-w-4xl w-full mx-4 py-4">
      <button id="closeGalleryBtn" class="absolute -top-10 right-0 text-white hover:text-secondary-light text-2xl">&times;</button>
      
      <div class="p-2">
        <h2 class="text-2xl font-bold text-primary-dark dark:text-primary-light text-center mb-4">Raya Gallery</h2>
        
        <!-- Slider Container -->
        <div class="relative overflow-hidden" style="height: 50vh; max-height: 500px;">
          <div id="sliderContainer" class="w-full h-full relative">
            <!-- Images will be inserted here by JavaScript -->
          </div>
          
          <!-- Navigation Arrows -->
          <button id="prevSlide" class="absolute left-0 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 hover:bg-opacity-70 text-white p-2 rounded-r-lg z-10">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
          </button>
          <button id="nextSlide" class="absolute right-0 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 hover:bg-opacity-70 text-white p-2 rounded-l-lg z-10">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </button>
        </div>
        
        <!-- Display Mode Toggle -->
        <div class="flex justify-center mt-4 gap-4">
          <button id="sliderMode" class="py-2 px-4 bg-primary text-white rounded-lg active">Slider</button>
          <button id="flipMode" class="py-2 px-4 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-white rounded-lg">Flip</button>
        </div>
        
        <!-- Image Counter -->
        <div class="text-center mt-2">
          <span id="currentSlide">1</span> / <span id="totalSlides">5</span>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // Element references
    const videoBtn = document.getElementById('videoBtn');
    const videoModal = document.getElementById('videoModal');
    const videoPlayer = document.getElementById('videoPlayer');
    const closeModalBtn = document.getElementById('closeModalBtn');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const playIcon = document.getElementById('playIcon');
    const pauseIcon = document.getElementById('pauseIcon');
    const backgroundMusic = document.getElementById('backgroundMusic');
    const volumeSlider = document.getElementById('volumeSlider');
    const audioVisualizer = document.getElementById('audioVisualizer');
    
    // Gallery references
    const galleryBtn = document.getElementById('galleryBtn');
    const galleryModal = document.getElementById('galleryModal');
    const closeGalleryBtn = document.getElementById('closeGalleryBtn');
    const sliderContainer = document.getElementById('sliderContainer');
    const prevSlide = document.getElementById('prevSlide');
    const nextSlide = document.getElementById('nextSlide');
    const sliderMode = document.getElementById('sliderMode');
    const flipMode = document.getElementById('flipMode');
    const currentSlideEl = document.getElementById('currentSlide');
    const totalSlidesEl = document.getElementById('totalSlides');
    
    // Gallery settings and state
    let currentSlide = 0;
    let displayMode = 'slider'; // 'slider' or 'flip'
    
    // Collection of images for the gallery 
    // These are programmatically generated patterns in different colors to avoid external dependencies
    const galleryImages = [
      generatePatternImage('mosque', '#8281E9', '#F385C7'), 
      generatePatternImage('ketupat', '#4A49B2', '#E15EB0'),
      generatePatternImage('crescent', '#8281E9', '#F385C7'),
      generatePatternImage('lamp', '#F385C7', '#4A49B2'),
      generatePatternImage('fireworks', '#E15EB0', '#8281E9')
    ];
    
    // Initialize the gallery and set the total slides
    totalSlidesEl.textContent = galleryImages.length.toString();
    
    // Function to generate a pattern SVG image based on the type
    function generatePatternImage(type, color1, color2) {
      const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
      svg.setAttribute("xmlns", "http://www.w3.org/2000/svg");
      svg.setAttribute("width", "600");
      svg.setAttribute("height", "400");
      svg.setAttribute("viewBox", "0 0 600 400");
      
      // Background
      const bg = document.createElementNS("http://www.w3.org/2000/svg", "rect");
      bg.setAttribute("width", "600");
      bg.setAttribute("height", "400");
      bg.setAttribute("fill", "#F8F8F8");
      svg.appendChild(bg);
      
      // Add pattern based on type
      if (type === 'mosque') {
        // Mosque silhouette and pattern
        const mosque = document.createElementNS("http://www.w3.org/2000/svg", "path");
        mosque.setAttribute("d", "M200,300 L400,300 L400,250 L380,250 L380,200 L360,200 L360,250 L340,250 L340,180 L320,180 L320,250 L300,250 L300,200 L280,200 L280,250 L260,250 L260,180 L240,180 L240,250 L220,250 L220,200 L200,200 Z");
        mosque.setAttribute("fill", color1);
        svg.appendChild(mosque);
        
        const dome = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        dome.setAttribute("cx", "300");
        dome.setAttribute("cy", "180");
        dome.setAttribute("r", "40");
        dome.setAttribute("fill", color2);
        svg.appendChild(dome);
        
        // Add decorative elements
        for (let i = 0; i < 10; i++) {
          const star = document.createElementNS("http://www.w3.org/2000/svg", "circle");
          star.setAttribute("cx", (50 + Math.random() * 500).toString());
          star.setAttribute("cy", (50 + Math.random() * 150).toString());
          star.setAttribute("r", (2 + Math.random() * 3).toString());
          star.setAttribute("fill", i % 2 === 0 ? color1 : color2);
          svg.appendChild(star);
        }
        
        // Add text
        const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
        text.setAttribute("x", "300");
        text.setAttribute("y", "350");
        text.setAttribute("text-anchor", "middle");
        text.setAttribute("font-family", "Arial, sans-serif");
        text.setAttribute("font-size", "24");
        text.setAttribute("fill", color1);
        text.textContent = "Selamat Hari Raya Aidilfitri";
        svg.appendChild(text);
        
      } else if (type === 'ketupat') {
        // Create a ketupat (diamond) pattern
        for (let i = 0; i < 5; i++) {
          for (let j = 0; j < 7; j++) {
            const ketupat = document.createElementNS("http://www.w3.org/2000/svg", "rect");
            ketupat.setAttribute("x", (100 + j * 70).toString());
            ketupat.setAttribute("y", (80 + i * 70).toString());
            ketupat.setAttribute("width", "50");
            ketupat.setAttribute("height", "50");
            ketupat.setAttribute("transform", "rotate(45 " + (125 + j * 70) + " " + (105 + i * 70) + ")");
            ketupat.setAttribute("fill", (i + j) % 2 === 0 ? color1 : color2);
            ketupat.setAttribute("stroke", "#FFFFFF");
            ketupat.setAttribute("stroke-width", "2");
            svg.appendChild(ketupat);
          }
        }
        
        // Add text
        const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
        text.setAttribute("x", "300");
        text.setAttribute("y", "40");
        text.setAttribute("text-anchor", "middle");
        text.setAttribute("font-family", "Arial, sans-serif");
        text.setAttribute("font-size", "24");
        text.setAttribute("fill", color1);
        text.textContent = "Ketupat Raya";
        svg.appendChild(text);
        
      } else if (type === 'crescent') {
        // Create crescent moon and stars
        const moon = document.createElementNS("http://www.w3.org/2000/svg", "path");
        moon.setAttribute("d", "M300,200 C300,255 255,300 200,300 C145,300 100,255 100,200 C100,145 145,100 200,100 C255,100 300,145 300,200 Z");
        moon.setAttribute("fill", color1);
        svg.appendChild(moon);
        
        const cover = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        cover.setAttribute("cx", "250");
        cover.setAttribute("cy", "200");
        cover.setAttribute("r", "100");
        cover.setAttribute("fill", "#F8F8F8");
        svg.appendChild(cover);
        
        // Add stars
        for (let i = 0; i < 15; i++) {
          const star = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
          const x = 350 + Math.random() * 200;
          const y = 50 + Math.random() * 300;
          const size = 5 + Math.random() * 10;
          
          let points = "";
          for (let j = 0; j < 5; j++) {
            const angle = j * 2 * Math.PI / 5 - Math.PI / 2;
            const px = x + size * Math.cos(angle);
            const py = y + size * Math.sin(angle);
            points += px + "," + py + " ";
            
            const innerAngle = angle + Math.PI / 5;
            const innerSize = size / 2.5;
            const ipx = x + innerSize * Math.cos(innerAngle);
            const ipy = y + innerSize * Math.sin(innerAngle);
            points += ipx + "," + ipy + " ";
          }
          
          star.setAttribute("points", points);
          star.setAttribute("fill", color2);
          svg.appendChild(star);
        }
        
        // Add text
        const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
        text.setAttribute("x", "300");
        text.setAttribute("y", "350");
        text.setAttribute("text-anchor", "middle");
        text.setAttribute("font-family", "Arial, sans-serif");
        text.setAttribute("font-size", "24");
        text.setAttribute("fill", color1);
        text.textContent = "Maaf Zahir dan Batin";
        svg.appendChild(text);
        
      } else if (type === 'lamp') {
        // Draw Raya lamps
        for (let i = 0; i < 3; i++) {
          const x = 150 + i * 150;
          
          // Lamp body
          const lamp = document.createElementNS("http://www.w3.org/2000/svg", "path");
          lamp.setAttribute("d", `M${x-30},150 L${x+30},150 L${x+25},250 L${x-25},250 Z`);
          lamp.setAttribute("fill", i % 2 === 0 ? color1 : color2);
          lamp.setAttribute("stroke", "#FFF");
          lamp.setAttribute("stroke-width", "2");
          svg.appendChild(lamp);
          
          // Lamp top
          const lampTop = document.createElementNS("http://www.w3.org/2000/svg", "path");
          lampTop.setAttribute("d", `M${x-30},150 L${x-10},130 L${x+10},130 L${x+30},150`);
          lampTop.setAttribute("fill", i % 2 === 0 ? color2 : color1);
          svg.appendChild(lampTop);
          
          // Lamp bottom
          const lampBottom = document.createElementNS("http://www.w3.org/2000/svg", "path");
          lampBottom.setAttribute("d", `M${x-25},250 L${x-15},270 L${x+15},270 L${x+25},250`);
          lampBottom.setAttribute("fill", i % 2 === 0 ? color2 : color1);
          svg.appendChild(lampBottom);
          
          // Hanging string
          const string = document.createElementNS("http://www.w3.org/2000/svg", "line");
          string.setAttribute("x1", x.toString());
          string.setAttribute("y1", "70");
          string.setAttribute("x2", x.toString());
          string.setAttribute("y2", "130");
          string.setAttribute("stroke", "#888");
          string.setAttribute("stroke-width", "2");
          svg.appendChild(string);
          
          // Lamp glow
          const glow = document.createElementNS("http://www.w3.org/2000/svg", "circle");
          glow.setAttribute("cx", x.toString());
          glow.setAttribute("cy", "200");
          glow.setAttribute("r", "60");
          glow.setAttribute("fill", "rgba(255, 255, 200, 0.3)");
          glow.setAttribute("fill-opacity", "0.3");
          svg.appendChild(glow);
        }
        
        // Add decorative line at top
        const topLine = document.createElementNS("http://www.w3.org/2000/svg", "line");
        topLine.setAttribute("x1", "100");
        topLine.setAttribute("y1", "70");
        topLine.setAttribute("x2", "500");
        topLine.setAttribute("y2", "70");
        topLine.setAttribute("stroke", "#888");
        topLine.setAttribute("stroke-width", "3");
        svg.appendChild(topLine);
        
        // Add text
        const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
        text.setAttribute("x", "300");
        text.setAttribute("y", "350");
        text.setAttribute("text-anchor", "middle");
        text.setAttribute("font-family", "Arial, sans-serif");
        text.setAttribute("font-size", "24");
        text.setAttribute("fill", color1);
        text.textContent = "Pelita Raya";
        svg.appendChild(text);
        
      } else if (type === 'fireworks') {
        // Draw fireworks celebration
        for (let i = 0; i < 5; i++) {
          const x = 100 + Math.random() * 400;
          const y = 70 + Math.random() * 200;
          const size = 30 + Math.random() * 50;
          const color = i % 2 === 0 ? color1 : color2;
          
          // Create the firework burst
          for (let angle = 0; angle < 360; angle += Math.random() * 15 + 10) {
            const radAngle = angle * Math.PI / 180;
            const length = size * (0.7 + Math.random() * 0.3);
            
            const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
            line.setAttribute("x1", x.toString());
            line.setAttribute("y1", y.toString());
            line.setAttribute("x2", (x + length * Math.cos(radAngle)).toString());
            line.setAttribute("y2", (y + length * Math.sin(radAngle)).toString());
            line.setAttribute("stroke", color);
            line.setAttribute("stroke-width", (1 + Math.random() * 2).toString());
            svg.appendChild(line);
            
            // Add small sparkles at the end of some lines
            if (Math.random() > 0.7) {
              const sparkle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
              sparkle.setAttribute("cx", (x + length * Math.cos(radAngle)).toString());
              sparkle.setAttribute("cy", (y + length * Math.sin(radAngle)).toString());
              sparkle.setAttribute("r", (1 + Math.random() * 2).toString());
              sparkle.setAttribute("fill", "#FFF");
              svg.appendChild(sparkle);
            }
          }
        }
        
        // Add a silhouette of a mosque at the bottom
        const mosque = document.createElementNS("http://www.w3.org/2000/svg", "path");
        mosque.setAttribute("d", "M100,400 L500,400 L500,350 L450,350 L450,320 L430,320 L430,350 L410,350 L410,300 L390,300 L390,350 L350,350 L350,330 L330,330 L330,350 L310,350 L310,330 L290,300 L270,330 L270,350 L250,350 L250,300 L230,300 L230,350 L190,350 L190,320 L170,320 L170,350 L150,350 L150,320 L100,320 Z");
        mosque.setAttribute("fill", "#000");
        svg.appendChild(mosque);
        
        // Add domes on the mosque
        const dome = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        dome.setAttribute("cx", "300");
        dome.setAttribute("cy", "300");
        dome.setAttribute("r", "20");
        dome.setAttribute("fill", "#000");
        svg.appendChild(dome);
        
        // Add text
        const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
        text.setAttribute("x", "300");
        text.setAttribute("y", "280");
        text.setAttribute("text-anchor", "middle");
        text.setAttribute("font-family", "Arial, sans-serif");
        text.setAttribute("font-size", "24");
        text.setAttribute("fill", "#FFF");
        text.textContent = "Selamat Hari Raya";
        svg.appendChild(text);
      }
      
      // Convert SVG to a data URL
      const serializer = new XMLSerializer();
      const svgString = serializer.serializeToString(svg);
      return 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svgString);
    }
    
    // Set initial volume for non-intrusive background music
    backgroundMusic.volume = 0.3;

    // Function to update audio visualizer state
    function updateVisualizerState() {
      if (backgroundMusic.paused) {
        audioVisualizer.classList.remove('active');
      } else {
        audioVisualizer.classList.add('active');
      }
    }
    
    // Initialize gallery slides
    function initializeGallery() {
      sliderContainer.innerHTML = '';
      
      galleryImages.forEach((src, index) => {
        const slide = document.createElement('div');
        slide.className = index === currentSlide ? 'absolute inset-0 flex items-center justify-center' : 'absolute inset-0 flex items-center justify-center hidden';
        
        const img = document.createElement('img');
        img.src = src;
        img.alt = `Raya Image ${index + 1}`;
        img.className = 'max-w-full max-h-full object-contain';
        
        slide.appendChild(img);
        sliderContainer.appendChild(slide);
      });
      
      updateSlideCounter();
    }
    
    // Update the slide counter
    function updateSlideCounter() {
      currentSlideEl.textContent = (currentSlide + 1).toString();
    }
    
    // Show a specific slide
    function showSlide(index) {
      // Remove all current animations and hide all slides
      const slides = sliderContainer.querySelectorAll('div');
      slides.forEach(slide => {
        slide.className = 'absolute inset-0 flex items-center justify-center hidden';
      });
      
      // Show the current slide with appropriate animation
      if (displayMode === 'slider') {
        slides[index].className = 'absolute inset-0 flex items-center justify-center slide-active';
      } else {
        slides[index].className = 'absolute inset-0 flex items-center justify-center flip-active';
      }
      
      currentSlide = index;
      updateSlideCounter();
    }
    
    // Navigate to previous slide
    function prevSlideHandler() {
      let newIndex = currentSlide - 1;
      if (newIndex < 0) newIndex = galleryImages.length - 1;
      showSlide(newIndex);
    }
    
    // Navigate to next slide
    function nextSlideHandler() {
      let newIndex = currentSlide + 1;
      if (newIndex >= galleryImages.length) newIndex = 0;
      showSlide(newIndex);
    }
    
    // Toggle between slider and flip modes
    function toggleDisplayMode(mode) {
      displayMode = mode;
      
      if (mode === 'slider') {
        sliderMode.className = 'py-2 px-4 bg-primary text-white rounded-lg';
        flipMode.className = 'py-2 px-4 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-white rounded-lg';
      } else {
        flipMode.className = 'py-2 px-4 bg-primary text-white rounded-lg';
        sliderMode.className = 'py-2 px-4 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-white rounded-lg';
      }
      
      // Reshow current slide with new animation
      showSlide(currentSlide);
    }
    
    // Handle autoplay issues on page load
    document.addEventListener('DOMContentLoaded', function() {
      // Attempt to play the audio (it is muted initially)
      backgroundMusic.play().then(() => {
        updateVisualizerState();
      }).catch(error => {
        console.log("Autoplay prevented: ", error);
        playIcon.classList.remove('hidden');
        pauseIcon.classList.add('hidden');
        updateVisualizerState();
      });

      // Automatically unmute after 5 seconds
      setTimeout(function() {
        backgroundMusic.muted = false;
        backgroundMusic.play().catch(error => {
          console.log("Error playing audio after unmute:", error);
        });
      }, 5000);
      
      // Initialize the gallery
      initializeGallery();
    });

    // Update volume from slider
    volumeSlider.addEventListener('input', function() {
      backgroundMusic.volume = this.value;
    });

    // Add audio event listeners to update visualizer state
    backgroundMusic.addEventListener('play', updateVisualizerState);
    backgroundMusic.addEventListener('pause', updateVisualizerState);
    backgroundMusic.addEventListener('ended', updateVisualizerState);

    // Control background music manually
    playPauseBtn.addEventListener('click', () => {
      if (backgroundMusic.paused) {
        backgroundMusic.play();
        playIcon.classList.add('hidden');
        pauseIcon.classList.remove('hidden');
      } else {
        backgroundMusic.pause();
        playIcon.classList.remove('hidden');
        pauseIcon.classList.add('hidden');
      }
    });

    // Video modal functionality
    videoBtn.addEventListener('click', () => {
      videoModal.classList.remove('hidden');
      videoPlayer.src = "https://finebank.github.io/uitmsabah/Selamat Hari Raya_20250326_191322_0000.mp4";

      // Pause the background music when video is opened
      backgroundMusic.pause();
      playIcon.classList.remove('hidden');
      pauseIcon.classList.add('hidden');
      updateVisualizerState();

      // Attempt to play video automatically
      videoPlayer.play().then(() => {
        console.log("Video started playing");
      }).catch(error => {
        console.log("Autoplay prevented for video: ", error);
      });
    });

    closeModalBtn.addEventListener('click', () => {
      videoModal.classList.add('hidden');
      videoPlayer.pause();
      videoPlayer.src = "";
    });
    
    // Gallery modal functionality
    galleryBtn.addEventListener('click', () => {
      galleryModal.classList.remove('hidden');
      
      // Initialize or refresh gallery
      initializeGallery();
      
      // Pause the background music when gallery is opened (optional)
      // backgroundMusic.pause();
      // playIcon.classList.remove('hidden');
      // pauseIcon.classList.add('hidden');
      // updateVisualizerState();
    });
    
    closeGalleryBtn.addEventListener('click', () => {
      galleryModal.classList.add('hidden');
    });
    
    // Gallery navigation
    prevSlide.addEventListener('click', prevSlideHandler);
    nextSlide.addEventListener('click', nextSlideHandler);
    
    // Display mode toggles
    sliderMode.addEventListener('click', () => toggleDisplayMode('slider'));
    flipMode.addEventListener('click', () => toggleDisplayMode('flip'));

    // Close modals when clicking outside the content
    videoModal.addEventListener('click', (e) => {
      if (e.target === videoModal) {
        videoModal.classList.add('hidden');
        videoPlayer.pause();
        videoPlayer.src = "";
      }
    });
    
    galleryModal.addEventListener('click', (e) => {
      if (e.target === galleryModal) {
        galleryModal.classList.add('hidden');
      }
    });

    // Listen for fullscreen change events
    document.addEventListener('fullscreenchange', exitHandler);
    document.addEventListener('webkitfullscreenchange', exitHandler);
    document.addEventListener('mozfullscreenchange', exitHandler);
    document.addEventListener('MSFullscreenChange', exitHandler);

    function exitHandler() {
      if (!document.fullscreenElement && 
          !document.webkitIsFullScreen && 
          !document.mozFullScreen && 
          !document.msFullscreenElement) {
        // The user has exited fullscreen mode; additional handling can be added here if needed.
      }
    }

    // Decorative animations for floating elements
    const floatingElements = document.querySelectorAll('.animate-float');
    floatingElements.forEach((elem, index) => {
      elem.style.animationDelay = `${index * 0.2}s`;
    });

    // Handle escape key to close modals
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        if (!videoModal.classList.contains('hidden')) {
          videoModal.classList.add('hidden');
          videoPlayer.pause();
          videoPlayer.src = "";
        }
        
        if (!galleryModal.classList.contains('hidden')) {
          galleryModal.classList.add('hidden');
        }
      }
    });
    
    // Add keyboard navigation for gallery
    document.addEventListener('keydown', (e) => {
      if (!galleryModal.classList.contains('hidden')) {
        if (e.key === 'ArrowLeft') {
          prevSlideHandler();
        } else if (e.key === 'ArrowRight') {
          nextSlideHandler();
        }
      }
    });
  </script>
</body>
</html>
